import{a as G}from"./chunk-OTUILQOT.js";import{a as Y,b as $}from"./chunk-PILLEFZM.js";import{a as q}from"./chunk-BHVEF5NT.js";import"./chunk-MGRSP4XQ.js";import"./chunk-RB7YJ4XU.js";import"./chunk-VAKUFGC6.js";import"./chunk-QUJFQN2Y.js";import"./chunk-PUF5RUX7.js";import"./chunk-ZSSIKXEX.js";import"./chunk-5EFE3HBG.js";import"./chunk-FI2Q437S.js";import"./chunk-CM5LPHNF.js";import"./chunk-SMWRAU6Q.js";import"./chunk-HBXR5O6M.js";import"./chunk-WZWUWUZB.js";import"./chunk-ZNCBGJQW.js";import"./chunk-CKP3SGE2.js";import"./chunk-RM2XG5VB.js";import{a as R}from"./chunk-GUCCS5WG.js";import{a as B}from"./chunk-3OT5IHQ2.js";import{a as z}from"./chunk-QIL4TVBT.js";import"./chunk-SZT74WTA.js";import"./chunk-22EA57K3.js";import"./chunk-LBMIQEU6.js";import"./chunk-WI5MSH4N.js";import{a as N}from"./chunk-CRPGW2PI.js";import{O as j}from"./chunk-GK747CHS.js";import"./chunk-ZFIWIRC4.js";import{Ca as h,Cb as T,Da as u,Ia as D,Ja as n,Ka as l,Kc as A,La as C,Mc as E,Ob as V,Pa as v,Qa as g,Ra as d,Rb as P,Sc as F,U as f,V as _,ab as m,ad as L,bb as b,cb as I,ed as O,kb as W,kc as M,na as c,qa as p,sa as x}from"./chunk-HGIDUMG6.js";import"./chunk-ADY6KXU2.js";import"./chunk-JFHB5KU2.js";import"./chunk-D2WB2TDK.js";import"./chunk-XWSGAIXU.js";import"./chunk-I5IPTR26.js";import"./chunk-4XLORUIW.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-O4PCMGUI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{m as y}from"./chunk-DDPKQVXB.js";var K=a=>({"background-image":a});function Q(a,s){if(a&1){let o=v();n(0,"button",13),g("click",function(){f(o);let e=d(2);return _(e.openMoodTracker())}),C(1,"ion-icon",14),n(2,"span"),m(3,"Mark as Complete"),l()()}}function U(a,s){if(a&1&&(n(0,"span"),m(1),l()),a&2){let o=d(3);c(),I("(",o.getDayWatchCount(o.day),")")}}function X(a,s){if(a&1){let o=v();n(0,"button",13),g("click",function(){f(o);let e=d(2);return _(e.openMoodTracker())}),C(1,"ion-icon",15),n(2,"span",16),m(3,"Completed "),h(4,U,2,1,"span"),l()()}if(a&2){let o=d(2);c(4),u(o.getDayWatchCount(o.day)>1?4:-1)}}function Z(a,s){if(a&1){let o=v();n(0,"button",13),g("click",function(){f(o);let e=d(2);return _(e.openMoodList(e.day))}),n(1,"span"),m(2,"\u{1F60A}"),l()()}}function tt(a,s){if(a&1){let o=v();n(0,"button",13),g("click",function(){f(o);let e=d(2);return _(e.addTofav())}),C(1,"ion-icon",17),n(2,"span"),m(3,"Add to Favorites"),l()()}}function et(a,s){if(a&1){let o=v();n(0,"button",13),g("click",function(){f(o);let e=d(2);return _(e.removeFromFavList())}),C(1,"ion-icon",18),n(2,"span"),m(3,"Added to Favorites"),l()()}}function it(a,s){if(a&1){let o=v();C(0,"div",3)(1,"div",4),n(2,"div",5)(3,"div",6)(4,"h1"),m(5),l(),n(6,"div",7),m(7),l(),n(8,"div",8)(9,"button",9),g("click",function(){f(o);let e=d();return _(e.onVideoOpen(e.data))}),C(10,"ion-icon",10),n(11,"span"),m(12,"Play"),l()()(),n(13,"div",11),h(14,Q,4,0,"button",12),h(15,X,5,1,"button",12),h(16,Z,3,0,"button",12),h(17,tt,4,0,"button",12),h(18,et,4,0,"button",12),l()()()}if(a&2){let o=d();D("ngStyle",W(8,K,"url("+o.data.postImage+")")),c(5),b(o.data.postTitle),c(2),b(o.data.post.description),c(7),u(o.isDayVideoWatched(o.day)?-1:14),c(),u(o.isDayVideoWatched(o.day)?15:-1),c(),u(o.checkMoodIconVisible(o.day)?16:-1),c(),u(o.checkFavorites()?-1:17),c(),u(o.checkFavorites()?18:-1)}}var _t=(()=>{let s=class s{constructor(t,e,i,r,k,H,J){this.route=t,this.router=e,this.navCtrl=i,this.apiService=r,this.authService=k,this.commonService=H,this.modalCtrl=J,this.workoutSeries=[],this.watchData=[],this.lastWatched=[],this.isCompleted=!1,this.programTitle="",this.favList=[];let w=this.router.getCurrentNavigation();if(w!=null&&w.extras.state){let S=w.extras.state;this.data=S.data,this.programId=S.data.programId,this.day=S.data.dayNumber,this.programTitle=S.programTitle,console.log(S.data,"ss")}}ngOnInit(){let t=this.authService.customer();t&&(this.status=t.status,t||(this.status=""),this.status!=="active"&&(this.status="inactive")),this.commonService.loader=!0,this.route.paramMap.subscribe(e=>{let i=e.params.id;this.loadData(),this.data?this.getFavList():this.apiService.getPostById(i).subscribe(r=>{console.log(r,"getPostById"),this.data=r,this.programId=r.programId,this.day=r.dayNumber,this.programTitle=r.programTitle,this.getFavList()})})}ngAfterViewInit(){setTimeout(()=>{let t=document.getElementById("play-btn");t&&t.focus()},2e3)}ionViewDidEnter(){setTimeout(()=>{console.log("ionViewDidEnter");let t=document.getElementById("play-btn");t&&t.focus()},3e3)}loadData(){console.log(this.authService.customer(),"customer"),this.authService.customer().programData[this.programId]?this.repeatCount=this.authService.customer().programData[this.programId].repeatCount:this.repeatCount=0,this.apiService.getWorkoutList().subscribe(t=>{this.workoutSeries=t.workout.map(e=>({id:e.id,image:e.image,title:e.title})),this.loadWatchData()})}loadWatchData(){let t={userId:this.authService.userObjData.email,programId:this.programId,repeatCount:this.repeatCount};this.apiService.geCompletetionDataOfSeries(t).subscribe(e=>{console.log(e),e.length>0?(this.watchData=e.filter(i=>i.day==this.day),console.log(this.watchData),this.getLastWatched(this.watchData),this.commonService.loader=!1):(this.watchData=[],this.commonService.loader=!1)},e=>{this.commonService.loader=!1})}onVideoOpen(t){return y(this,null,function*(){if(t.post.type=="Byo")return;let e={title:t.postTitle,image:t.postImage,videoId:t.id,video:t.post.media,description:""};try{yield(yield this.modalCtrl.create({component:G,componentProps:{video:e},cssClass:"video-player-modal",showBackdrop:!0,backdropDismiss:!0})).present()}catch(i){console.error("Error opening video modal:",i)}})}onViewAllWorkoutsSeries(){this.router.navigate(["/workout-series-list"])}onCardWorkoutsSeries(t){this.navCtrl.navigateForward(`/workout-day-series/${t.id}`,{state:{data:t}})}getLastWatched(t){let e=t.filter(i=>i.day===String(this.day));e.length>1&&e.sort((i,r)=>i.date-r.date),this.lastWatched=e}isDayVideoWatched(t){return this.watchData.filter(i=>i.day==t).length>0}openMoodTracker(){return y(this,null,function*(){let t=yield this.modalCtrl.create({component:Y,cssClass:"mood-tracker-modal",componentProps:{data:null}});yield t.present();let{data:e}=yield t.onWillDismiss();e&&(console.log("Selected mood:",e),this.saveMarkAsComplete(e))})}saveMarkAsComplete(t){var i;this.isCompleted=this.isDayVideoWatched(this.day);let e={category:"workout-series",isCompletedEmails:(i=this.authService.customer().isCompletedEmails)!=null?i:!1,energyData:t,userId:this.authService.userObjData.email,title:this.data.postTitle,programTitle:this.programTitle,durationMinutes:this.data.post.durationMinutes,watchCount:this.isCompleted?this.getDayWatchCount(this.day)+1:1,repeatCount:this.repeatCount,isEnergyDataAvailable:!!t,programId:this.programId,day:this.day};console.log(e),this.isCompleted?this.openDialog(e):this.apiService.markAsComplete(e).subscribe(r=>{r&&this.loadWatchData()})}getMaxWatchCount(){return this.watchData?this.watchData.length:0}openDialog(t){return y(this,null,function*(){let e=yield this.modalCtrl.create({component:R,componentProps:{title:"Confirm Action",message:"Are you sure you want to mark this video as complete again?",confirmText:"Yes",cancelText:"No"},cssClass:"confirm-modal"});yield e.present();let{data:i}=yield e.onWillDismiss();i&&(console.log("Selected:",i),this.apiService.markAsComplete(t).subscribe(r=>{console.log(r),this.loadWatchData()}))})}getDayWatchCount(t){if(this.watchData&&this.watchData.length)return this.watchData.filter(i=>i.day===t).length}checkMoodIconVisible(t){return this.watchData&&this.watchData.length?this.watchData.filter(i=>i.day===t).length>0:!1}openMoodList(t){return y(this,null,function*(){let e=this.watchData.filter(k=>k.day==t),i=yield this.modalCtrl.create({component:$,componentProps:{data:e},cssClass:"mood-list-dialog"});yield i.present();let{data:r}=yield i.onWillDismiss()})}getFavList(){this.apiService.getFavorites(this.authService.userObjData.email).subscribe(t=>{console.log(t,"favlist"),this.favList=t.favorites;let e=this.favList.find(i=>i.postId===this.data.postId);e&&(this.favDocid=e.docid),console.log(this.favDocid,"this.favDocid ")})}addTofav(){let t={id:this.data.id,postId:this.data.postId,email:this.authService.userObjData.email,title:this.data.postTitle,image:this.data.postImage,type:this.data.post.type,media:this.data.post.media,description:this.data.post.description,duration:this.data.post.duration,equipment:this.data.post.equipment,categories:this.data.post.categories,categoryArray:this.data.post.categoryArray,ingredients:this.data.post.ingredients};this.apiService.addFavorites(t).subscribe(e=>{console.log(e),this.getFavList()})}removeFromFavList(){console.log(this.favDocid),this.apiService.deleteFavorites(this.favDocid).subscribe(t=>{this.getFavList()})}checkFavorites(){let t=this.favList;if(t)return t&&t.filter(e=>e.postId===this.data.postId).length}};s.\u0275fac=function(e){return new(e||s)(p(V),p(P),p(M),p(B),p(j),p(N),p(L))},s.\u0275cmp=x({type:s,selectors:[["app-workout-series-detail"]],decls:5,vars:4,consts:[[1,"mt-3"],["size","12"],[3,"viewAllClick","videoClick","status","videos","title"],[1,"hero-background",3,"ngStyle"],[1,"hero-overlay"],[1,"hero-content"],[1,"hero-title"],[1,"hero-description"],[1,"hero-actions"],["id","play-btn","tabindex","0",1,"btn-icon-primary","ion",3,"click"],["name","play","slot","start"],[1,"d-flex","gap-2","mt-3","flex-wrap"],["tabindex","0",1,"btn-icon-primary"],["tabindex","0",1,"btn-icon-primary",3,"click"],["name","checkmark-circle-outline"],["name","checkmark-done-circle-outline"],[1,"me-2"],["name","heart-outline"],["name","heart"]],template:function(e,i){e&1&&(h(0,it,19,10),n(1,"ion-grid",0)(2,"ion-row")(3,"ion-col",1)(4,"app-video-section",2),g("viewAllClick",function(){return i.onViewAllWorkoutsSeries()})("videoClick",function(k){return i.onCardWorkoutsSeries(k)}),l()()()()),e&2&&(u(i.data?0:-1),c(4),D("status",i.status)("videos",i.workoutSeries)("title","Top Workout Series"))},dependencies:[z,A,E,F,O,T,q],styles:[".hero-background[_ngcontent-%COMP%]{position:fixed!important;top:0;left:0;right:0;bottom:0;background-size:contain;background-repeat:no-repeat;background-position:top;filter:brightness(.4) blur(0px);z-index:1}.hero-overlay[_ngcontent-%COMP%]{position:fixed!important;top:0;left:0;right:0;bottom:-100px;background:linear-gradient(to top,#000 20%,#0003);z-index:1}.hero-content[_ngcontent-%COMP%]{position:relative;z-index:3;display:flex;align-items:flex-start;padding-left:1vw;padding-top:0}.hero-title[_ngcontent-%COMP%]{max-width:500px;color:#fff}.hero-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin-bottom:1rem}.hero-description[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:2rem;color:#fff;text-shadow:0 2px 8px rgba(0,0,0,.7)}.hero-actions[_ngcontent-%COMP%]   .ion[_ngcontent-%COMP%]{margin-right:1rem;font-size:1.5rem}"]});let a=s;return a})();export{_t as WorkoutSeriesDetailPage};
