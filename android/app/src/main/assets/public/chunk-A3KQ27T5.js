import{a as F}from"./chunk-OTUILQOT.js";import{a as R,b as U}from"./chunk-PILLEFZM.js";import{a as H}from"./chunk-NDZZC2VM.js";import{a as L}from"./chunk-GUCCS5WG.js";import{a as j}from"./chunk-3OT5IHQ2.js";import{a as G}from"./chunk-QIL4TVBT.js";import{a as z}from"./chunk-CRPGW2PI.js";import{O as E}from"./chunk-GK747CHS.js";import"./chunk-ZFIWIRC4.js";import{Bb as B,Ca as f,Cb as A,Da as v,Ia as k,Ja as a,Ka as c,La as x,Ob as T,Pa as D,Qa as y,Ra as s,Rb as V,U as C,V as _,ab as p,ad as N,bb as I,cb as W,ed as O,kb as P,na as d,qa as m,sa as S,wa as M}from"./chunk-HGIDUMG6.js";import"./chunk-ADY6KXU2.js";import"./chunk-JFHB5KU2.js";import"./chunk-D2WB2TDK.js";import"./chunk-XWSGAIXU.js";import"./chunk-I5IPTR26.js";import"./chunk-4XLORUIW.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-O4PCMGUI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{g as q,m as h}from"./chunk-DDPKQVXB.js";var Y=q(H());var J=o=>({"background-image":o});function K(o,r){if(o&1){let i=D();a(0,"button",9),y("click",function(){C(i);let e=s(2);return _(e.openMoodTracker(e.videoData.title,e.videoData.value))}),x(1,"ion-icon",10),a(2,"span"),p(3,"Mark as Complete"),c()()}}function Q(o,r){if(o&1&&(a(0,"span"),p(1),c()),o&2){let i=s(3);d(),W("(",i.getWatchCount(i.getGroupByDataByName(i.videoData.title)),")")}}function X(o,r){if(o&1){let i=D();a(0,"button",9),y("click",function(){C(i);let e=s(2);return _(e.openMoodTracker(e.videoData.title,e.videoData.value))}),x(1,"ion-icon",11),a(2,"span",12),p(3,"Completed "),M(4,Q,2,1,"span",13),c()()}if(o&2){let i=s(2);d(4),k("ngIf",i.getWatchCount(i.getGroupByDataByName(i.videoData.title))>1)}}function Z(o,r){if(o&1){let i=D();a(0,"button",9),y("click",function(){C(i);let e=s(2);return _(e.openMoodList(e.getGroupByDataByName(e.videoData.title)))}),a(1,"span"),p(2,"\u{1F60A}"),c()()}}function $(o,r){if(o&1){let i=D();x(0,"div",0)(1,"div",1),a(2,"div",2)(3,"div",3)(4,"h1"),p(5),c(),a(6,"div",4)(7,"button",5),y("click",function(){C(i);let e=s();return _(e.onVideoOpen(e.videoData))}),x(8,"ion-icon",6),a(9,"span"),p(10,"Play"),c()()(),a(11,"div",7),f(12,K,4,0,"button",8),f(13,X,5,1,"button",8),f(14,Z,3,0,"button",8),c()()()}if(o&2){let i=s();k("ngStyle",P(5,J,"url("+i.videoData.image+")")),d(5),I(i.videoData.title),d(7),v(i.getWatchCount(i.getGroupByDataByName(i.videoData.title))?-1:12),d(),v(i.getWatchCount(i.getGroupByDataByName(i.videoData.title))?13:-1),d(),v(i.checkMoodIconVisible(i.getGroupByDataByName(i.videoData.title))?14:-1)}}var pt=(()=>{let r=class r{constructor(t,e,n,l,b,w){this.route=t,this.router=e,this.authService=n,this.apiService=l,this.modalCtrl=b,this.commonService=w,this.groupBydata={},this.title="";let u=this.router.getCurrentNavigation();if(console.log(u,"navigation"),u!=null&&u.extras.state){let g=u.extras.state;this.videoData=g.data,this.challengeId=g.challengeId,this.category=g.category,this.title=g.challengeName,console.log(g,"ss")}}ngOnInit(){this.loadWatchData(),setTimeout(()=>{let t=document.getElementById("play-btn");t&&t.focus()},3e3)}ionViewDidEnter(){setTimeout(()=>{let t=document.getElementById("play-btn");console.log(t,"col"),t&&t.focus()},3e3)}loadWatchData(){let t={userId:this.authService.userObjData.email,challengeId:this.challengeId,category:this.category};this.apiService.geWatchCompletedDataOfCoolDownOrWarmUp(t).subscribe(e=>{this.groupBydata=Y.groupBy(e,"title")})}onVideoOpen(t){return h(this,null,function*(){let e={title:t.title,image:t.image,videoId:t.title,video:t.media,description:""};try{yield(yield this.modalCtrl.create({component:F,componentProps:{video:e},cssClass:"video-player-modal",showBackdrop:!0,backdropDismiss:!0})).present()}catch(n){console.error("Error opening video modal:",n)}})}getGroupNametemplate(t){return t+" - "+this.title}getGroupByDataByName(t){return this.groupBydata[this.getGroupNametemplate(t)]||[]}getWatchCount(t){var e;return(e=t==null?void 0:t.length)!=null?e:0}openMoodTracker(t,e){return h(this,null,function*(){let n=yield this.modalCtrl.create({component:R,cssClass:"mood-tracker-modal",componentProps:{data:null}});yield n.present();let{data:l}=yield n.onWillDismiss();l&&(console.log("Selected mood:",l),this.saveMarkAsComplete(t,e,l))})}saveMarkAsComplete(t,e=0,n){var b;let l={category:this.category,isCompletedEmails:(b=this.authService.customer().isCompletedEmails)!=null?b:!1,energyData:n,userId:this.authService.userObjData.email,title:this.getGroupNametemplate(t),durationMinutes:this.videoData.durationMinutes,watchCount:this.getWatchCount(this.groupBydata[this.getGroupNametemplate(t)]||[])+1,isEnergyDataAvailable:!!n,challengeId:this.challengeId};console.log(l),this.getWatchCount(this.groupBydata[this.getGroupNametemplate(t)]||[])>0?this.openDialog(l):this.apiService.markAsComplete(l).subscribe(w=>{w&&this.loadWatchData()})}checkMoodIconVisible(t){return this.getWatchCount(t),!!(t&&t.length)}openDialog(t){return h(this,null,function*(){let e=yield this.modalCtrl.create({component:L,componentProps:{title:"Confirm Action",message:"Are you sure you want to mark this video as complete again?",confirmText:"Yes",cancelText:"No"},cssClass:"confirm-modal"});yield e.present();let{data:n}=yield e.onWillDismiss();n&&(console.log("Selected:",n),this.apiService.markAsComplete(t).subscribe(l=>{console.log(l),this.loadWatchData()}))})}openMoodList(t){return h(this,null,function*(){let e=yield this.modalCtrl.create({component:U,componentProps:{data:t},cssClass:"mood-list-dialog"});yield e.present();let{data:n}=yield e.onWillDismiss();n&&this.loadWatchData()})}};r.\u0275fac=function(e){return new(e||r)(m(T),m(V),m(E),m(j),m(N),m(z))},r.\u0275cmp=S({type:r,selectors:[["app-challenge-warmup-and-cooldown-detail"]],decls:1,vars:1,consts:[[1,"hero-background",3,"ngStyle"],[1,"hero-overlay"],[1,"hero-content"],[1,"hero-title"],[1,"hero-actions"],["id","play-btn","tabindex","0",1,"btn-icon-primary","ion",3,"click"],["name","play","slot","start"],[1,"d-flex","gap-2","mt-3","flex-wrap"],["tabindex","0",1,"btn-icon-primary"],["tabindex","0",1,"btn-icon-primary",3,"click"],["name","checkmark-circle-outline"],["name","checkmark-done-circle-outline"],[1,"me-2"],[4,"ngIf"]],template:function(e,n){e&1&&f(0,$,15,7),e&2&&v(n.videoData?0:-1)},dependencies:[G,O,B,A],styles:[".hero-background[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-size:contain;background-repeat:no-repeat;background-position:top;filter:brightness(.4) blur(0px);z-index:1}.hero-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:-100px;background:linear-gradient(to top,#000 20%,#0003);z-index:1}.hero-content[_ngcontent-%COMP%]{position:relative;z-index:3;display:flex;align-items:flex-start;padding-left:1vw;padding-top:0}.hero-title[_ngcontent-%COMP%]{max-width:500px;color:#fff}.hero-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin-bottom:1rem}.hero-description[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:2rem;color:#fff;text-shadow:0 2px 8px rgba(0,0,0,.7)}.hero-actions[_ngcontent-%COMP%]   .ion[_ngcontent-%COMP%]{margin-right:1rem;font-size:1.5rem}"]});let o=r;return o})();export{pt as ChallengeWarmupAndCooldownDetailPage};
