import{a as G}from"./chunk-OTUILQOT.js";import{a as Y,b as H}from"./chunk-PILLEFZM.js";import{a as R}from"./chunk-BHVEF5NT.js";import"./chunk-MGRSP4XQ.js";import"./chunk-RB7YJ4XU.js";import"./chunk-VAKUFGC6.js";import"./chunk-QUJFQN2Y.js";import"./chunk-PUF5RUX7.js";import"./chunk-ZSSIKXEX.js";import"./chunk-5EFE3HBG.js";import"./chunk-FI2Q437S.js";import"./chunk-CM5LPHNF.js";import"./chunk-SMWRAU6Q.js";import"./chunk-HBXR5O6M.js";import"./chunk-WZWUWUZB.js";import"./chunk-ZNCBGJQW.js";import"./chunk-CKP3SGE2.js";import"./chunk-RM2XG5VB.js";import{a as q}from"./chunk-GUCCS5WG.js";import{a as B}from"./chunk-3OT5IHQ2.js";import{a as z}from"./chunk-QIL4TVBT.js";import"./chunk-SZT74WTA.js";import"./chunk-22EA57K3.js";import"./chunk-LBMIQEU6.js";import"./chunk-WI5MSH4N.js";import{a as N}from"./chunk-CRPGW2PI.js";import{O as j}from"./chunk-GK747CHS.js";import"./chunk-ZFIWIRC4.js";import{Ca as d,Cb as P,Da as m,Ia as D,Ja as n,Ka as c,Kc as F,La as v,Mc as A,Ob as I,Pa as f,Qa as C,Ra as s,Rb as T,Sc as E,U as p,V as _,ab as h,ad as L,bb as W,cb as y,ed as O,kb as V,kc as M,na as l,qa as g,sa as S}from"./chunk-HGIDUMG6.js";import"./chunk-ADY6KXU2.js";import"./chunk-JFHB5KU2.js";import"./chunk-D2WB2TDK.js";import"./chunk-XWSGAIXU.js";import"./chunk-I5IPTR26.js";import"./chunk-4XLORUIW.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-O4PCMGUI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{m as x}from"./chunk-DDPKQVXB.js";var Q=a=>({"background-image":a});function U(a,r){if(a&1&&(n(0,"div",5),h(1),c()),a&2){let i=s(2);l(),y(" ",i.data.description," ")}}function X(a,r){if(a&1){let i=f();n(0,"button",11),C("click",function(){p(i);let t=s(2);return _(t.openMoodTracker())}),v(1,"ion-icon",12),n(2,"span"),h(3,"Mark as Complete"),c()()}}function Z(a,r){if(a&1&&(n(0,"span"),h(1),c()),a&2){let i=s(3);l(),y("(",i.getDayWatchCount(i.day),")")}}function $(a,r){if(a&1){let i=f();n(0,"button",11),C("click",function(){p(i);let t=s(2);return _(t.openMoodTracker())}),v(1,"ion-icon",13),n(2,"span",14),h(3,"Completed "),d(4,Z,2,1,"span"),c()()}if(a&2){let i=s(2);l(4),m(i.getDayWatchCount(i.day)>1?4:-1)}}function tt(a,r){if(a&1){let i=f();n(0,"button",11),C("click",function(){p(i);let t=s(2);return _(t.openMoodList(t.day))}),n(1,"span"),h(2,"\u{1F60A}"),c()()}}function et(a,r){if(a&1){let i=f();n(0,"button",11),C("click",function(){p(i);let t=s(2);return _(t.addTofav())}),v(1,"ion-icon",15),n(2,"span"),h(3,"Add to Favorites"),c()()}}function it(a,r){if(a&1){let i=f();n(0,"button",11),C("click",function(){p(i);let t=s(2);return _(t.removeFromFavList())}),v(1,"ion-icon",16),n(2,"span"),h(3,"Added to Favorites"),c()()}}function ot(a,r){if(a&1){let i=f();v(0,"div",1)(1,"div",2),n(2,"div",3)(3,"div",4)(4,"h1"),h(5),c(),d(6,U,2,1,"div",5),n(7,"div",6)(8,"button",7),C("click",function(){p(i);let t=s();return _(t.onVideoOpen(t.data))}),v(9,"ion-icon",8),n(10,"span"),h(11,"Play"),c()()(),n(12,"div",9),d(13,X,4,0,"button",10),d(14,$,5,1,"button",10),d(15,tt,3,0,"button",10),d(16,et,4,0,"button",10),d(17,it,4,0,"button",10),c()()()}if(a&2){let i=s();D("ngStyle",V(8,Q,"url("+i.data.image+")")),l(5),W(i.data.title),l(),m(i.data!=null&&i.data.description?6:-1),l(7),m(i.isDayVideoWatched(i.day)?-1:13),l(),m(i.isDayVideoWatched(i.day)?14:-1),l(),m(i.checkMoodIconVisible(i.day)?15:-1),l(),m(i.checkFavorites()?-1:16),l(),m(i.checkFavorites()?17:-1)}}function at(a,r){if(a&1){let i=f();n(0,"ion-grid",0)(1,"ion-row")(2,"ion-col",17)(3,"app-video-section",18),C("viewAllClick",function(){p(i);let t=s();return _(t.onViewAllWorkouts())})("videoClick",function(t){p(i);let o=s();return _(o.onCardWorkouts(t))}),c()()()()}if(a&2){let i=s();l(3),D("status",i.status)("videos",i.workouts)("title","Top Workout")}}var vt=(()=>{let r=class r{constructor(e,t,o,u,w,J,K){this.route=e,this.router=t,this.navCtrl=o,this.apiService=u,this.commonService=w,this.authService=J,this.modalCtrl=K,this.workouts=[],this.watchData=[],this.lastWatched=[],this.isCompleted=!1,this.programTitle="",this.favList=[],this.isFav=!1;let k=this.router.getCurrentNavigation();if(k!=null&&k.extras.state){let b=k.extras.state;this.data=b.data,console.log(b.data,"ss")}}ngOnInit(){let e=this.authService.customer();e&&(this.status=e.status,e||(this.status=""),this.status!=="active"&&(this.status="inactive")),this.route.paramMap.subscribe(t=>{this.isFav=this.route.snapshot.queryParams.isFav||!1,console.log(this.isFav,"this.isFav "),this.programId=t.params.id,this.data?(this.getFavList(),this.loadData()):this.apiService.getPostById(this.programId).subscribe(o=>{this.data=o,this.getFavList(),this.loadData()})})}ngAfterViewInit(){setTimeout(()=>{let e=document.getElementById("play-btn");e&&e.focus()},2e3)}ionViewDidEnter(){setTimeout(()=>{console.log("ionViewDidEnter");let e=document.getElementById("play-btn");e&&e.focus()},3e3)}loadData(){this.apiService.getCategoriesList().subscribe(e=>{this.workouts=e.categories.workouts.map(t=>({id:t.id,image:t.imagePath,title:t.title})),this.loadWatchData()})}loadWatchData(){let e={userId:this.authService.userObjData.email,postId:this.programId,category:"workouts"};this.apiService.geCompletetionDataOfWorkout(e).subscribe(t=>{console.log(t),t.length>0?(this.watchData=t.filter(o=>o.day==this.day),console.log(this.watchData),this.getLastWatched(this.watchData),this.commonService.loader=!1):(this.watchData=[],this.commonService.loader=!1)},t=>{this.commonService.loader=!1})}onVideoOpen(e){return x(this,null,function*(){if(e.type=="Byo")return;let t={title:e.title,image:e.image,videoId:e.id,video:e.media,description:""};try{yield(yield this.modalCtrl.create({component:G,componentProps:{video:t},cssClass:"video-player-modal",showBackdrop:!0,backdropDismiss:!0})).present()}catch(o){console.error("Error opening video modal:",o)}})}onViewAllWorkouts(){this.router.navigate(["/workout-list"])}onCardWorkouts(e){this.router.navigate(["/workout-day/",e.id])}getLastWatched(e){let t=e.filter(o=>o.day===String(this.day));t.length>1&&t.sort((o,u)=>o.date-u.date),this.lastWatched=t}isDayVideoWatched(e){return this.watchData.filter(o=>o.day==e).length>0}openMoodTracker(){return x(this,null,function*(){let e=yield this.modalCtrl.create({component:Y,cssClass:"mood-tracker-modal",componentProps:{data:null}});yield e.present();let{data:t}=yield e.onWillDismiss();t&&(console.log("Selected mood:",t),this.saveMarkAsComplete(t))})}saveMarkAsComplete(e){var o;this.isCompleted=this.isDayVideoWatched(this.day);let t={category:"workouts",isCompletedEmails:(o=this.authService.customer().isCompletedEmails)!=null?o:!1,energyData:e,userId:this.authService.userObjData.email,title:this.data.title,durationMinutes:this.data.durationMinutes,watchCount:this.isCompleted?this.getDayWatchCount(this.day)+1:1,isEnergyDataAvailable:!!e,postId:this.programId,day:this.day};console.log(t),this.isCompleted?this.openDialog(t):this.apiService.markAsComplete(t).subscribe(u=>{u&&this.loadWatchData()})}getMaxWatchCount(){return this.watchData?this.watchData.length:0}openDialog(e){return x(this,null,function*(){let t=yield this.modalCtrl.create({component:q,componentProps:{title:"Confirm Action",message:"Are you sure you want to mark this video as complete again?",confirmText:"Yes",cancelText:"No"},cssClass:"confirm-modal"});yield t.present();let{data:o}=yield t.onWillDismiss();o&&(console.log("Selected:",o),this.apiService.markAsComplete(e).subscribe(u=>{console.log(u),this.loadWatchData()}))})}getDayWatchCount(e){if(this.watchData&&this.watchData.length)return this.watchData.filter(o=>o.day===e).length}checkMoodIconVisible(e){return this.watchData&&this.watchData.length?this.watchData.filter(o=>o.day===e).length>0:!1}openMoodList(e){return x(this,null,function*(){let t=this.watchData.filter(w=>w.day==e),o=yield this.modalCtrl.create({component:H,componentProps:{data:t},cssClass:"mood-list-dialog"});yield o.present();let{data:u}=yield o.onWillDismiss()})}getFavList(){this.apiService.getFavorites(this.authService.userObjData.email).subscribe(e=>{console.log(e,"favlist"),this.favList=e.favorites;let t=this.favList.find(o=>o.postId===this.data.id);t&&(this.favDocid=t.docid),console.log(this.favDocid,"this.favDocid ")})}addTofav(){let e={id:this.data.id,postId:this.data.id,email:this.authService.userObjData.email,title:this.data.title,image:this.data.image,type:this.data.type,media:this.data.media,description:this.data.description,duration:this.data.duration,equipment:this.data.equipment,categories:this.data.categories,categoryArray:this.data.categoryArray,ingredients:this.data.ingredients};this.apiService.addFavorites(e).subscribe(t=>{console.log(t),this.getFavList()})}removeFromFavList(){console.log(this.favDocid),this.apiService.deleteFavorites(this.favDocid).subscribe(e=>{this.getFavList()})}checkFavorites(){let e=this.favList;if(e)return e&&e.filter(t=>t.postId===this.data.id).length}};r.\u0275fac=function(t){return new(t||r)(g(I),g(T),g(M),g(B),g(N),g(j),g(L))},r.\u0275cmp=S({type:r,selectors:[["app-workout-detail"]],decls:2,vars:2,consts:[[1,"mt-3"],[1,"hero-background",3,"ngStyle"],[1,"hero-overlay"],[1,"hero-content"],[1,"hero-title"],[1,"hero-description"],[1,"hero-actions"],["id","play-btn","tabindex","0",1,"btn-icon-primary","ion",3,"click"],["name","play","slot","start"],[1,"d-flex","gap-2","mt-3","flex-wrap"],["tabindex","0",1,"btn-icon-primary"],["tabindex","0",1,"btn-icon-primary",3,"click"],["name","checkmark-circle-outline"],["name","checkmark-done-circle-outline"],[1,"me-2"],["name","heart-outline"],["name","heart"],["size","12"],[3,"viewAllClick","videoClick","status","videos","title"]],template:function(t,o){t&1&&(d(0,ot,18,10),d(1,at,4,3,"ion-grid",0)),t&2&&(m(o.data?0:-1),l(),m(o.isFav?-1:1))},dependencies:[z,F,A,E,O,P,R],styles:[".hero-background[_ngcontent-%COMP%]{position:fixed!important;top:0;left:0;right:0;bottom:0;background-size:contain;background-repeat:no-repeat;background-position:top;filter:brightness(.4) blur(0px);z-index:1}.hero-overlay[_ngcontent-%COMP%]{position:fixed!important;top:0;left:0;right:0;bottom:-100px;background:linear-gradient(to top,#000 20%,#0003);z-index:1}.hero-content[_ngcontent-%COMP%]{position:relative;z-index:3;display:flex;align-items:flex-start;padding-left:1vw;padding-top:0}.hero-title[_ngcontent-%COMP%]{max-width:500px;color:#fff}.hero-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin-bottom:1rem}.hero-description[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:2rem;color:#fff;text-shadow:0 2px 8px rgba(0,0,0,.7)}.hero-actions[_ngcontent-%COMP%]   .ion[_ngcontent-%COMP%]{margin-right:1rem;font-size:1.5rem}"]});let a=r;return a})();export{vt as WorkoutDetailPage};
