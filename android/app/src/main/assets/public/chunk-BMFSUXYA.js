import{a as U,b as Y}from"./chunk-PILLEFZM.js";import{a as H}from"./chunk-GUCCS5WG.js";import{a as N}from"./chunk-3OT5IHQ2.js";import{a as q}from"./chunk-QIL4TVBT.js";import{a as G}from"./chunk-CRPGW2PI.js";import{O as B}from"./chunk-GK747CHS.js";import{a as $}from"./chunk-ZFIWIRC4.js";import{Ca as d,Da as h,Ea as y,Fc as W,Ga as I,Ha as T,Hc as V,Ia as v,Ja as n,Jc as L,Ka as c,Kc as j,La as b,Mc as A,Ob as E,Pa as _,Qa as C,Ra as m,Rb as F,Sc as O,U as g,V as f,ab as r,ad as R,bb as w,cb as x,ed as z,hb as M,jb as P,ka as S,na as l,qa as p,sa as k}from"./chunk-HGIDUMG6.js";import"./chunk-ADY6KXU2.js";import"./chunk-JFHB5KU2.js";import"./chunk-D2WB2TDK.js";import"./chunk-XWSGAIXU.js";import"./chunk-I5IPTR26.js";import"./chunk-4XLORUIW.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-O4PCMGUI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{m as D}from"./chunk-DDPKQVXB.js";var Q=()=>({height:"120px",width:"calc(25% - 10px)"});function X(i,s){if(i&1&&(n(0,"p",9),r(1),c(),n(2,"p",9),r(3),c()),i&2){let o=m();l(),x(" Repitition : ",o.comboDetails==null?null:o.comboDetails.repeatCount," times "),l(2),x(" Rest Time : ",o.comboDetails==null?null:o.comboDetails.restTime," seconds ")}}function Z(i,s){if(i&1){let o=_();n(0,"button",10),C("click",function(){g(o);let e=m();return f(e.openMoodTracker())}),b(1,"ion-icon",11),n(2,"span"),r(3,"Mark as Complete"),c()()}}function tt(i,s){if(i&1&&(n(0,"span"),r(1),c()),i&2){let o=m(2);l(),x("(",o.getWatchCount(),")")}}function et(i,s){if(i&1){let o=_();n(0,"button",10),C("click",function(){g(o);let e=m();return f(e.openMoodTracker())}),b(1,"ion-icon",12),n(2,"span",13),r(3,"Completed "),d(4,tt,2,1,"span"),c()()}if(i&2){let o=m();l(4),h(o.getWatchCount()>1?4:-1)}}function it(i,s){if(i&1){let o=_();n(0,"button",14),C("click",function(){g(o);let e=m();return f(e.openMoodList())}),n(1,"span"),r(2,"\u{1F60A}"),c()()}}function ot(i,s){if(i&1){let o=_();n(0,"button",14),C("click",function(){g(o);let e=m();return f(e.addTofav())}),b(1,"ion-icon",15),n(2,"span"),r(3,"Add to Favorites"),c()()}}function at(i,s){if(i&1){let o=_();n(0,"button",14),C("click",function(){g(o);let e=m();return f(e.removeFromFavList())}),b(1,"ion-icon",16),n(2,"span"),r(3,"Added to Favorites"),c()()}}function nt(i,s){if(i&1&&(n(0,"ion-col",1)(1,"ion-card",17)(2,"div",18),b(3,"img",19),c(),n(4,"ion-card-header")(5,"ion-card-title"),r(6),c()()()()),i&2){let o=s.$implicit,t=s.$index;l(),v("id",M("combo-details-card-",t))("tabindex",0),l(2),v("src",o.postDetails.media,S),l(3),w(o.postDetails.title)}}function st(i,s){if(i&1&&I(0,nt,7,5,"ion-col",1,y),i&2){let o=m();T(o.comboDetails==null?null:o.comboDetails.comboWorkouts)}}function lt(i,s){i&1&&b(0,"ngx-skeleton-loader",8),i&2&&v("theme",P(1,Q))}var _t=(()=>{let s=class s{constructor(t,e,a,u,J,K){this.route=t,this.modalCtrl=e,this.apiService=a,this.router=u,this.commonService=J,this.authService=K,this.title="",this.watchData=[],this.isCompleted=!1,this.favList=[]}ngOnInit(){this.commonService.loader=!0,this.route.paramMap.subscribe(t=>{this.id=t.params.id,console.log(t,this.id),this.loadData()})}loadData(){this.apiService.getComboDetails(this.id).subscribe(t=>{this.comboDetails=t,console.log(this.comboDetails,"this.comboDetails"),this.loadWatchData(),this.getFavList()})}loadWatchData(){let t={userId:this.authService.userObjData.email,comboId:this.id,category:"byo-combo"};this.apiService.geCompletetionDataOfByo(t).subscribe(e=>{console.log(e),e.length>0?(this.watchData=e,this.isCompleted=!0,this.watchCount=this.getWatchCount(),this.commonService.loader=!1):(this.isCompleted=!1,this.watchData=[],this.commonService.loader=!1)},e=>{this.commonService.loader=!1})}ngAfterViewInit(){setTimeout(()=>{let t=document.getElementById("combobtn");t&&t.focus()},2e3)}startCombo(){this.router.navigate(["/play-combo"],{queryParams:{id:this.comboDetails.id,title:this.comboDetails.name}})}openMoodTracker(){return D(this,null,function*(){let t=yield this.modalCtrl.create({component:U,cssClass:"mood-tracker-modal",componentProps:{data:null}});yield t.present();let{data:e}=yield t.onWillDismiss();e&&(console.log("Selected mood:",e),this.saveMarkAsComplete(e))})}saveMarkAsComplete(t){var a;this.watchCount=this.isCompleted?this.getMaxWatchCount():1;let e={comboId:this.id,userId:this.authService.userObjData.email,category:"byo-combo",subCategory:this.comboDetails.type,title:this.comboDetails.name,durationMinutes:this.comboDetails.durationMinutes,watchCount:this.isCompleted?this.getMaxWatchCount()+1:1,isCompletedEmails:(a=this.authService.customer().isCompletedEmails)!=null?a:!1,isEnergyDataAvailable:!!t,energyData:t};console.log(e),this.isCompleted?this.openDialog(e):this.apiService.markAsComplete(e).subscribe(u=>{console.log(u),u&&this.loadWatchData()})}getMaxWatchCount(){return this.watchData?this.watchData.length:0}getWatchCount(){return(this.watchData?this.watchData.filter(e=>e.comboId===String(this.id)):[]).length}openDialog(t){return D(this,null,function*(){let e=yield this.modalCtrl.create({component:H,componentProps:{title:"Confirm Action",message:"Are you sure you want to mark this video as complete again?",confirmText:"Yes",cancelText:"No"},cssClass:"confirm-modal"});yield e.present();let{data:a}=yield e.onWillDismiss();a&&(console.log("Selected:",a),this.apiService.markAsComplete(t).subscribe(u=>{console.log(u),this.loadWatchData()}))})}getDayWatchCount(t){if(this.watchData&&this.watchData.length)return this.watchData.filter(a=>a.day===t).length}checkMoodIconVisible(){return this.watchData&&this.watchData.length?this.watchData.length>0:!1}openMoodList(){return D(this,null,function*(){let t=yield this.modalCtrl.create({component:Y,componentProps:{data:this.watchData},cssClass:"mood-list-dialog"});yield t.present();let{data:e}=yield t.onWillDismiss()})}getFavList(){this.apiService.getFavorites(this.authService.userObjData.email).subscribe(t=>{console.log(t,"favlist"),this.favList=t.favorites;let e=this.favList.find(a=>a.postId===this.comboDetails.id);e&&(this.favDocid=e.docid),console.log(this.favDocid,"this.favDocid ")})}addTofav(){let t={id:this.comboDetails.id,postId:this.comboDetails.id,email:this.authService.userObjData.email,title:this.comboDetails.name,image:"",type:"byo-combo",media:""};this.apiService.addFavorites(t).subscribe(e=>{console.log(e),this.getFavList()})}removeFromFavList(){console.log(this.favDocid),this.apiService.deleteFavorites(this.favDocid).subscribe(t=>{this.getFavList()})}checkFavorites(){let t=this.favList;if(t)return t&&t.filter(e=>e.postId===this.comboDetails.id).length}};s.\u0275fac=function(e){return new(e||s)(p(E),p(R),p(N),p(F),p(G),p(B))},s.\u0275cmp=k({type:s,selectors:[["app-combo-details"]],decls:20,vars:9,consts:[[1,"mb-3"],["size","3"],[1,"text-white","text-start","p-0","mt-0"],["size","6",1,"text-end"],[1,"d-flex","justify-content-end","align-items-center"],["id","combobtn",1,"btn-icon-primary","me-2",3,"click","tabindex"],["tabindex","0",1,"btn-icon-primary"],["tabindex","0",1,"btn-icon-primary","ms-2"],["count","4","appearance","square",1,"custom-skeleton-width",3,"theme"],[1,"text-white","mb-0"],["tabindex","0",1,"btn-icon-primary",3,"click"],["name","checkmark-circle-outline"],["name","checkmark-done-circle-outline"],[1,"me-2"],["tabindex","0",1,"btn-icon-primary","ms-2",3,"click"],["name","heart-outline"],["name","heart"],[1,"custom-card",3,"id","tabindex"],[1,"image-container-placeholder"],["alt","image",3,"src"]],template:function(e,a){e&1&&(n(0,"ion-grid")(1,"ion-row",0)(2,"ion-col",1)(3,"h1",2),r(4),c()(),n(5,"ion-col",1),d(6,X,4,2),c(),n(7,"ion-col",3)(8,"div",4)(9,"button",5),C("click",function(){return a.startCombo()}),n(10,"span"),r(11,"Start Combo"),c()(),d(12,Z,4,0,"button",6),d(13,et,5,1,"button",6),d(14,it,3,0,"button",7),d(15,ot,4,0,"button",7),d(16,at,4,0,"button",7),c()()(),n(17,"ion-row"),d(18,st,2,0)(19,lt,1,2,"ngx-skeleton-loader",8),c()()),e&2&&(l(4),w(a.comboDetails==null?null:a.comboDetails.name),l(2),h(a.comboDetails!=null&&a.comboDetails.restTime?6:-1),l(3),v("tabindex",0),l(3),h(a.getWatchCount()?-1:12),l(),h(a.getWatchCount()?13:-1),l(),h(a.checkMoodIconVisible()?14:-1),l(),h(a.checkFavorites()?-1:15),l(),h(a.checkFavorites()?16:-1),l(2),h((a.comboDetails==null?null:a.comboDetails.comboWorkouts.length)>0?18:19))},dependencies:[q,j,A,O,W,V,L,z,$],styles:[".image-container-placeholder[_ngcontent-%COMP%]{background-color:#6464646b;height:150px;max-height:150px;min-height:150px}.image-container-placeholder[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:150px;max-height:150px;min-height:150px;object-fit:cover}"]});let i=s;return i})();export{_t as ComboDetailsPage};
