import{a as $}from"./chunk-OTUILQOT.js";import{a as H,b as J}from"./chunk-PILLEFZM.js";import{a as Y}from"./chunk-BHVEF5NT.js";import"./chunk-MGRSP4XQ.js";import"./chunk-RB7YJ4XU.js";import"./chunk-VAKUFGC6.js";import"./chunk-QUJFQN2Y.js";import"./chunk-PUF5RUX7.js";import"./chunk-ZSSIKXEX.js";import"./chunk-5EFE3HBG.js";import"./chunk-FI2Q437S.js";import"./chunk-CM5LPHNF.js";import"./chunk-SMWRAU6Q.js";import"./chunk-HBXR5O6M.js";import"./chunk-WZWUWUZB.js";import"./chunk-ZNCBGJQW.js";import"./chunk-CKP3SGE2.js";import"./chunk-RM2XG5VB.js";import{a as G}from"./chunk-GUCCS5WG.js";import{a as R}from"./chunk-3OT5IHQ2.js";import{a as B}from"./chunk-QIL4TVBT.js";import"./chunk-SZT74WTA.js";import"./chunk-22EA57K3.js";import"./chunk-LBMIQEU6.js";import"./chunk-WI5MSH4N.js";import{a as q}from"./chunk-CRPGW2PI.js";import{O as N}from"./chunk-GK747CHS.js";import"./chunk-ZFIWIRC4.js";import{Bb as P,Ca as f,Cb as T,Da as _,Ia as w,Ja as n,Ka as s,Kc as W,La as C,Mc as L,Ob as M,Pa as v,Qa as h,Ra as d,Rb as A,Sc as O,U as u,V as g,ab as m,ad as j,bb as S,cb as F,ed as z,kb as V,kc as E,na as c,qa as p,sa as k,wa as I}from"./chunk-HGIDUMG6.js";import"./chunk-ADY6KXU2.js";import"./chunk-JFHB5KU2.js";import"./chunk-D2WB2TDK.js";import"./chunk-XWSGAIXU.js";import"./chunk-I5IPTR26.js";import"./chunk-4XLORUIW.js";import"./chunk-4U6PRYVA.js";import"./chunk-FXFZIWDD.js";import"./chunk-CSG5OQLY.js";import"./chunk-VMHM3MLJ.js";import"./chunk-O4PCMGUI.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{m as y}from"./chunk-DDPKQVXB.js";var U=o=>({"background-image":o});function X(o,r){if(o&1){let a=v();n(0,"button",13),h("click",function(){u(a);let e=d(2);return g(e.openMoodTracker())}),C(1,"ion-icon",14),n(2,"span"),m(3,"Mark as Complete"),s()()}}function Z(o,r){if(o&1&&(n(0,"span"),m(1),s()),o&2){let a=d(3);c(),F("(",a.getDayWatchCount(a.day),")")}}function tt(o,r){if(o&1){let a=v();n(0,"button",13),h("click",function(){u(a);let e=d(2);return g(e.openMoodTracker())}),C(1,"ion-icon",15),n(2,"span",16),m(3,"Completed "),I(4,Z,2,1,"span",17),s()()}if(o&2){let a=d(2);c(4),w("ngIf",a.getDayWatchCount(a.day)>1)}}function et(o,r){if(o&1){let a=v();n(0,"button",13),h("click",function(){u(a);let e=d(2);return g(e.openMoodList(e.day))}),n(1,"span"),m(2,"\u{1F60A}"),s()()}}function it(o,r){if(o&1){let a=v();n(0,"button",13),h("click",function(){u(a);let e=d(2);return g(e.addTofav())}),C(1,"ion-icon",18),n(2,"span"),m(3,"Add to Favorites"),s()()}}function at(o,r){if(o&1){let a=v();n(0,"button",13),h("click",function(){u(a);let e=d(2);return g(e.removeFromFavList())}),C(1,"ion-icon",19),n(2,"span"),m(3,"Added to Favorites"),s()()}}function ot(o,r){if(o&1){let a=v();C(0,"div",3)(1,"div",4),n(2,"div",5)(3,"div",6)(4,"h1"),m(5),s(),n(6,"div",7),m(7),s(),n(8,"div",8)(9,"button",9),h("click",function(){u(a);let e=d();return g(e.onVideoOpen(e.programData))}),C(10,"ion-icon",10),n(11,"span"),m(12,"Play"),s()()(),n(13,"div",11),f(14,X,4,0,"button",12),f(15,tt,5,1,"button",12),f(16,et,3,0,"button",12),f(17,it,4,0,"button",12),f(18,at,4,0,"button",12),s()()()}if(o&2){let a=d();w("ngStyle",V(8,U,"url("+a.programData.post.image+")")),c(5),S(a.programData.postTitle),c(2),S(a.programData.post.description),c(7),_(a.isDayVideoWatched(a.day)?-1:14),c(),_(a.isDayVideoWatched(a.day)?15:-1),c(),_(a.checkMoodIconVisible(a.day)?16:-1),c(),_(a.checkFavorites()?-1:17),c(),_(a.checkFavorites()?18:-1)}}var vt=(()=>{let r=class r{constructor(t,e,i,l,D,K,Q){this.route=t,this.router=e,this.navCtrl=i,this.apiService=l,this.authService=D,this.modalCtrl=K,this.commonService=Q,this.programs=[],this.watchData=[],this.lastWatched=[],this.isCompleted=!1,this.favList=[];let b=this.router.getCurrentNavigation();if(b!=null&&b.extras.state){let x=b.extras.state;this.fitnessData=x.fitnessData,this.programData=x.programData,this.day=x.programData.dayNumber,console.log(x,"ss")}}ngOnInit(){this.getFavList();let t=this.authService.customer();t&&(this.status=t.status,t||(this.status=""),this.status!=="active"&&(this.status="inactive")),this.commonService.loader=!0,this.route.paramMap.subscribe(e=>{this.programId=this.programData.programId,this.loadData()})}loadWatchData(){let t={userId:this.authService.userObjData.email,programId:this.programId,repeatCount:this.repeatCount};this.apiService.geCompletetionDataOfSeries(t).subscribe(e=>{console.log(e),e.length>0?(this.watchData=e.filter(i=>i.day==this.day),console.log(this.watchData),this.getLastWatched(this.watchData),this.commonService.loader=!1):(this.watchData=[],this.commonService.loader=!1)},e=>{this.commonService.loader=!1})}ngAfterViewInit(){setTimeout(()=>{let t=document.getElementById("play-btn");t&&t.focus()},2e3)}ionViewDidEnter(){setTimeout(()=>{console.log("ionViewDidEnter");let t=document.getElementById("play-btn");t&&t.focus()},3e3)}loadData(){console.log(this.authService.customer(),"customer"),this.authService.customer().programData[this.programId]?this.repeatCount=this.authService.customer().programData[this.programId].repeatCount:this.repeatCount=0,this.apiService.getFitnessList().subscribe(t=>{this.programs=t["30day"].map(e=>({id:e.id,image:e.image,title:e.title})),this.loadWatchData()})}onVideoOpen(t){return y(this,null,function*(){if(t.post.type=="Byo")return;let e={title:t.postTitle,image:t.postImage,videoId:t.id,video:t.post.media,description:""};try{yield(yield this.modalCtrl.create({component:$,componentProps:{video:e},cssClass:"video-player-modal",showBackdrop:!0,backdropDismiss:!0})).present()}catch(i){console.error("Error opening video modal:",i)}})}onViewAllFitness(){this.router.navigate(["/fitness-list"])}onCardFitness(t){this.navCtrl.navigateForward(`/program/${t.id}`,{state:{data:t}})}getLastWatched(t){let e=t.filter(i=>i.day===String(this.day));e.length>1&&e.sort((i,l)=>i.date-l.date),this.lastWatched=e}isDayVideoWatched(t){return this.watchData.filter(i=>i.day==t).length>0}openMoodTracker(){return y(this,null,function*(){let t=yield this.modalCtrl.create({component:H,cssClass:"mood-tracker-modal",componentProps:{data:null}});yield t.present();let{data:e}=yield t.onWillDismiss();e&&(console.log("Selected mood:",e),this.saveMarkAsComplete(e))})}saveMarkAsComplete(t){var i;this.isCompleted=this.isDayVideoWatched(this.day);let e={category:"30day",isCompletedEmails:(i=this.authService.customer().isCompletedEmails)!=null?i:!1,energyData:t,userId:this.authService.userObjData.email,title:this.programData.postTitle,programTitle:this.fitnessData.title,durationMinutes:this.programData.post.durationMinutes,watchCount:this.isCompleted?this.getDayWatchCount(this.day)+1:1,repeatCount:this.repeatCount,isEnergyDataAvailable:!!t,programId:this.programId,day:this.day};console.log(e),this.isCompleted?this.openDialog(e):this.apiService.markAsComplete(e).subscribe(l=>{l&&this.loadWatchData()})}getMaxWatchCount(){return this.watchData?this.watchData.length:0}openDialog(t){return y(this,null,function*(){let e=yield this.modalCtrl.create({component:G,componentProps:{title:"Confirm Action",message:"Are you sure you want to mark this video as complete again?",confirmText:"Yes",cancelText:"No"},cssClass:"confirm-modal"});yield e.present();let{data:i}=yield e.onWillDismiss();i&&(console.log("Selected:",i),this.apiService.markAsComplete(t).subscribe(l=>{console.log(l),this.loadWatchData()}))})}getDayWatchCount(t){if(this.watchData&&this.watchData.length)return this.watchData.filter(i=>i.day===t).length}checkMoodIconVisible(t){return this.watchData&&this.watchData.length?this.watchData.filter(i=>i.day===t).length>0:!1}openMoodList(t){return y(this,null,function*(){let e=this.watchData.filter(D=>D.day==t),i=yield this.modalCtrl.create({component:J,componentProps:{data:e},cssClass:"mood-list-dialog"});yield i.present();let{data:l}=yield i.onWillDismiss()})}getFavList(){this.apiService.getFavorites(this.authService.userObjData.email).subscribe(t=>{console.log(t,"favlist"),this.favList=t.favorites;let e=this.favList.find(i=>i.postId===this.programData.postId);e&&(this.favDocid=e.docid),console.log(this.favDocid,"this.favDocid ")})}addTofav(){let t={id:this.programData.id,postId:this.programData.postId,email:this.authService.userObjData.email,title:this.programData.postTitle,image:this.programData.postImage,type:this.programData.post.type,media:this.programData.post.media,description:this.programData.post.description,duration:this.programData.post.duration,equipment:this.programData.post.equipment,categories:this.programData.post.categories,categoryArray:this.programData.post.categoryArray,ingredients:this.programData.post.ingredients};this.apiService.addFavorites(t).subscribe(e=>{console.log(e),this.getFavList()})}removeFromFavList(){console.log(this.favDocid),this.apiService.deleteFavorites(this.favDocid).subscribe(t=>{this.getFavList()})}checkFavorites(){let t=this.favList;if(t)return t&&t.filter(e=>e.postId===this.programData.postId).length}};r.\u0275fac=function(e){return new(e||r)(p(M),p(A),p(E),p(R),p(N),p(j),p(q))},r.\u0275cmp=k({type:r,selectors:[["app-fitness-detail"]],decls:5,vars:5,consts:[[1,"mt-3"],["size","12"],[3,"viewAllClick","videoClick","status","isDetailPage","videos","title"],[1,"hero-background",3,"ngStyle"],[1,"hero-overlay"],[1,"hero-content"],[1,"hero-title"],[1,"hero-description"],[1,"hero-actions"],["id","play-btn","tabindex","0",1,"btn-icon-primary","ion",3,"click"],["name","play","slot","start"],[1,"d-flex","gap-2","mt-3","flex-wrap"],["tabindex","0",1,"btn-icon-primary"],["tabindex","0",1,"btn-icon-primary",3,"click"],["name","checkmark-circle-outline"],["name","checkmark-done-circle-outline"],[1,"me-2"],[4,"ngIf"],["name","heart-outline"],["name","heart"]],template:function(e,i){e&1&&(f(0,ot,19,10),n(1,"ion-grid",0)(2,"ion-row")(3,"ion-col",1)(4,"app-video-section",2),h("viewAllClick",function(){return i.onViewAllFitness()})("videoClick",function(D){return i.onCardFitness(D)}),s()()()()),e&2&&(_(i.programData?0:-1),c(4),w("status",i.status)("isDetailPage",!0)("videos",i.programs)("title","Top Fitness"))},dependencies:[B,W,L,O,z,P,T,Y],styles:[".hero-background[_ngcontent-%COMP%]{position:fixed!important;top:0;left:0;right:0;bottom:0;background-size:contain;background-repeat:no-repeat;background-position:top;filter:brightness(.4) blur(0px);z-index:1}.hero-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;bottom:-100px;background:linear-gradient(to top,#000 20%,#0003);z-index:1}.hero-content[_ngcontent-%COMP%]{position:relative;z-index:3;display:flex;align-items:flex-start;padding-left:1vw;padding-top:0}.hero-title[_ngcontent-%COMP%]{max-width:500px;color:#fff}.hero-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin-bottom:1rem}.hero-description[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:2rem;color:#fff;text-shadow:0 2px 8px rgba(0,0,0,.7)}.hero-actions[_ngcontent-%COMP%]   .ion[_ngcontent-%COMP%]{margin-right:1rem;font-size:1.5rem}"]});let o=r;return o})();export{vt as FitnessDetailPage};
